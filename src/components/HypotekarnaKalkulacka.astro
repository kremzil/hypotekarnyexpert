---

---
<div class="mt-10 grid gap-10 lg:grid-cols-12 animate-target opacity-0 transition-all duration-700">
    <form   class="rounded-2xl bg-neutral-50 p-6 space-y-6 lg:col-span-7 shadow-sm">
        <label class="grid  gap-2 text-sm text-dark">
            Výška hypotéky
            <input
                id="vyska"
                type="number"
                inputmode="decimal"
                min="0"
                step="0.1"
                value="40000"
                class="w-full rounded-md px-4 py-2 border-neutral-700  bg-ink text-dark shadow-sm focus:border-paper"
            />
        </label>
        <label class="grid  gap-2 text-sm text-dark">
            Akontácia
            <input
                id="akontacia"
                type="number"
                inputmode="decimal"
                min="0"
                step="0.1"
                value="0"
                class="w-full rounded-md px-4 py-2 border-neutral-700  bg-ink text-dark shadow-sm focus:border-paper"
            />
        </label>
                <label class="grid  gap-2 text-sm text-dark">
            Dĺžka úveru (v rokoch)
            <input
                id="dlzka"
                type="number"
                inputmode="decimal"
                min="0"
                step="0.1"
                value="10"
                class="w-full rounded-md px-4 py-2 border-neutral-700  bg-ink text-dark shadow-sm focus:border-paper"
            />
        </label>
                <label class="grid  gap-2 text-sm text-dark">
            Úroková sadzba (ročne)
            <input
                id="rate"
                type="number"
                inputmode="decimal"
                min="0"
                step="0.1"
                value="2"
                class="w-full rounded-md px-4 py-2 border-neutral-700  bg-ink text-dark shadow-sm focus:border-paper"
            />
        </label>
    </form>
          <div class="lg:col-span-5">
        <div class="rounded-2xl bg-neutral-50 p-6 shadow-sm">
          <h3 class="text-dark  border-paper-alt border-dotted border-b-2">Výsledok</h3>
          <div class="mt-6 space-y-4">
            <div class="flex items-center justify-between gap-4">
              <span class="text-sm font-bold text-dark">Mesačná splátka</span>
              <output id="splatka" class="text-lg font-medium text-dark">€0.00</output>
            </div>
            <div class="flex items-center justify-between gap-4">
              <span class="text-sm text-dark">Preplatená suma</span>
              <output id="preplatok" class="text-lg font-medium text-dark">€0.00</output>
            </div>
            <div class="flex items-center justify-between gap-4">
              <span class="text-sm text-dark">Celková suma zaplatená</span>
              <output id="suma" class="text-lg font-medium text-dark">€0.00</output>
            </div>
          </div>
        </div>
      </div>
</div>
<script>
  const form = document.getElementById("kalkulacka") as HTMLFormElement | null;
  if (form) {
    const vyskaInput = document.getElementById("vyska") as HTMLInputElement | null;
    const akontaciaInput = document.getElementById("akontacia") as HTMLInputElement | null;
    const dlzkaInput = document.getElementById("dlzka") as HTMLInputElement | null;
    const rateInput = document.getElementById("rate") as HTMLInputElement | null;
    const splatkaOutput = document.getElementById("splatka") as HTMLOutputElement | null;
    const preplatokOutput = document.getElementById("preplatok") as HTMLOutputElement | null;
    const sumaOutput = document.getElementById("suma") as HTMLOutputElement | null;

    const formatter = new Intl.NumberFormat("sk-SK", {
      style: "currency",
      currency: "EUR",
      minimumFractionDigits: 2,
      maximumFractionDigits: 2,
    });

    const readNumber = (input: HTMLInputElement | null) => {
      if (!input) return 0;
      const normalized = input.value.replace(",", ".");
      const value = Number.parseFloat(normalized);
      return Number.isFinite(value) ? value : 0;
    };

    const setOutputs = (payment: number, totalPaid: number, overpayment: number) => {
      if (splatkaOutput) splatkaOutput.textContent = formatter.format(payment);
      if (sumaOutput) sumaOutput.textContent = formatter.format(totalPaid);
      if (preplatokOutput) preplatokOutput.textContent = formatter.format(overpayment);
    };

    const calculate = () => {
      const vyska = Math.max(0, readNumber(vyskaInput));
      const akontacia = Math.max(0, readNumber(akontaciaInput));
      const years = Math.max(0, readNumber(dlzkaInput));
      const rateAnnual = Math.max(0, readNumber(rateInput));

      const principal = Math.max(0, vyska - akontacia);
      const months = Math.round(years * 12);
      if (principal === 0 || months === 0) {
        setOutputs(0, 0, 0);
        return;
      }

      const monthlyRate = rateAnnual / 100 / 12;
      let payment = 0;
      if (monthlyRate === 0) {
        payment = principal / months;
      } else {
        const factor = Math.pow(1 + monthlyRate, months);
        payment = (principal * monthlyRate * factor) / (factor - 1);
      }

      const totalPaid = payment * months;
      const overpayment = totalPaid - principal;
      setOutputs(payment, totalPaid, overpayment);
    };

    [vyskaInput, akontaciaInput, dlzkaInput, rateInput].forEach((input) => {
      if (!input) return;
      input.addEventListener("input", calculate);
    });

    calculate();
  }
</script>
