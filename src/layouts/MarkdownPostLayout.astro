---
import BaseLayout from "./BaseLayout.astro";
import { SITE } from "../config/site";
import { Image } from "astro:assets";
import ShareButtons from "../components/ShareButtons.astro";

const { frontmatter, prevPost, nextPost } = Astro.props;
const hasPrev = Boolean(prevPost);
const hasNext = Boolean(nextPost);
const { title, description, pubDate, author, tags, image } = frontmatter;
const imageUrl = typeof image === "string" ? image : image?.url;
const imageAlt = typeof image === "object" && image ? image.alt : title;
const formattedDate = new Intl.DateTimeFormat(SITE.dateLocale, {
  year: "numeric",
  month: "long",
  day: "2-digit"
}).format(pubDate);
---

<BaseLayout title={title} description={description} image={imageUrl}>
 <main class="surface  pt-20 pb-16">

    <article class="card relative mx-auto max-w-170 px-4 pb-12 pt-10 sm:px-6 sm:pb-16 lg:pt-16">
                  <ShareButtons />
      <div class="eyebrow text-xs text-neutral-500">

        {formattedDate}
      </div>
      <h1 class="mt-4 text-4xl font-normal tracking-tight text-neutral-900 sm:text-5xl">
        {frontmatter.title}
      </h1>
      {frontmatter.description && (
        <p class="mt-4 text-lg text-neutral-600">{frontmatter.description}</p>
      )}
      <p class="eyebrow mt-3 text-sm text-neutral-500">
        Autor: <span class="text-neutral-700">{frontmatter.author}</span>
      </p>
      {Array.isArray(tags) && tags.length > 0 && (
        <div class="mt-3 flex flex-wrap gap-2 text-xs text-neutral-500">
          {tags.map((tag) => (
            <span class="rounded-full border border-neutral-200 px-2.5 py-1 text-neutral-600">
              {tag}
            </span>
          ))}
        </div>
      )}

      {imageUrl && (
        <div class="card mt-8 overflow-hidden shadow-lg">
          <Image
            src={imageUrl}
            width={1200}
            sizes="(min-width: 1024px) 768px, 100vw"
            alt={imageAlt ?? title}
            class="h-72 w-full object-cover sm:h-96"
          />
        </div>
      )}

      <div class="mt-10 space-y-6 text-[1.05rem] leading-8 text-neutral-800 [&_h2]:mt-12 [&_h2]:text-3xl [&_h2]:font-normal [&_h3]:mt-8 [&_h3]:text-2xl [&_h3]:font-normal [&_ul]:list-disc [&_ul]:pl-6 [&_ol]:list-decimal [&_ol]:pl-6 [&_blockquote]:border-l-4 [&_blockquote]:border-accent [&_blockquote]:pl-4 [&_blockquote]:text-neutral-600 [&_a]:text-accent [&_a]:underline-offset-4 [&_a]:hover:underline">
        <slot />
      </div>

      {(hasPrev || hasNext) && (
        <nav
          class="mt-12 flex flex-col gap-4 border-t border-neutral-200 pt-8 sm:flex-row"
          aria-label="Post navigation"
        >
          {hasPrev && (
            <a
              href={`/blog/${prevPost.id}/`}
              class="card group flex-1 p-5 transition duration-300 hover:-translate-y-0.5 hover:shadow-md"
            >
              <span class="text-xs uppercase tracking-[0.2em] text-neutral-500">
                &larr; Predchadzajuci prispevok
              </span>
              <span class="mt-2 block text-lg font-semibold text-neutral-900 transition-colors group-hover:text-accent">
                {prevPost.data?.title}
              </span>
            </a>
          )}
          {hasNext && (
            <a
              href={`/blog/${nextPost.id}/`}
              class={`card group flex-1 p-5 text-right transition duration-300 hover:-translate-y-0.5 hover:shadow-md ${
                !hasPrev ? "sm:ml-auto" : ""
              }`}
            >
              <span class="text-xs uppercase tracking-[0.2em] text-neutral-500">
                Nasledujuci prispevok &rarr;
              </span>
              <span class="mt-2 block text-lg font-semibold text-neutral-900 transition-colors group-hover:text-accent">
                {nextPost.data?.title}
              </span>
            </a>
          )}
        </nav>
      )}

    </article>
  </main>
</BaseLayout>
